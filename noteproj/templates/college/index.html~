{% extends "base.html" %}
{% load humanize %}
{% block content %}
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>

<script>
// this might be messed up sorry but hopefully jquery works for upvoting -bks
// kind is there in case we ever want to implement downvoting?
	function upvote(pk, kind) {
		$.getJSON("/upvote/", { pk:pk, vote: kind }, 
		function(json){
			
			$("#ratingDiv-" + String(pk)).text(String(json['points']) + " points");
			
		});
	}
	function addClickHandlers() {
		$("#upvote").click( function() { upvote("up") });
	}
	
	$(document).ready(addClickHandlers);
</script>
 
<div class="well span8">
                <dl>
                    {% for post in posts.object_list %}
                        <table>
                        <tr>
                        <td><a href="#" id="upvote" onclick="upvote('{{post.pk}}', 'up');">
                        
                                {% if post not in user.likes.all or user == 'Anonymous' %}^&nbsp;{% else %}

                                <font color="red">&nbsp;&nbsp;</font>{% endif %} 
								
                            </a>
                        </td>
                        <td>
                                <table>
                                <tr><td>
                                    <a href="{{post.link}}">{{post.title}}</a>
                                </td></tr>
                                <tr><td>
                                    {{post.description}}
                                </td></tr>
                                <tr><td>
                                <small>by 
                                <a href="/users/{{post.user}}/">{{post.user}}</a>
                                
                                
                                {{post.created|naturaltime}} | 
                                <a href="{% url notes.views.post post.pk %}">{{post.num_comments}} 
                                
                                {% if post.num_comments == 1 %}
                                Comment
                                {% else %}
                                Comments
                                {%endif%}
                                
                                
                                </a> | <div id="ratingDiv-{{post.pk}}">{{post.rating}} points</div></small>
                                
                                </td></tr>
                                </table>
                        </td>
                        </tr>
                        </table>
                        <br>
                    {% endfor %}
                </dl>

        <!-- Next/Prev page links  -->

{% if posts.object_list and posts.paginator.num_pages > 1 %}

    <div class="pagination">
    <ul>

		{% if posts.has_previous %}
		    <li>
				  <a href= "?page={{ posts.previous_page_number }}">Prev</a>
				    

		    </li>
		 {% else %}<li class="disabled">
				    <a href= "">Prev</a>

		</li>
		{% endif %}



    <li><a>{{ posts.number }} of {{ posts.paginator.num_pages }}</a></li>
		{% if posts.has_next %}
		    <li>
				  <a href= "?page={{ posts.next_page_number }}">Next</a>
				    

		    </li>
		 {% else %}<li class="disabled">
				    <a href= "">Next</a>

		</li>
		{% endif %}
    </ul>
    </div>
{% endif %}


        
</div>
      {% endblock %}


