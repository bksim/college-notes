{% extends "base.html" %}
{% load humanize %}
{% block content %}
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>

<script>
// this might be messed up sorry but hopefully jquery works for upvoting -bks
// kind is there in case we ever want to implement downvoting?
	function upvote(pk, kind) {
		$.getJSON("/upvote/", { pk:pk, vote: kind }, 
		function(json){
			alert("Was successful?: " + json['success']);
			$("#ratingDiv-" + String(pk)).text(String(json['points']) + " points");
			alert("successful again: " + $("#ratingDiv-" + String(pk)).text());
		});
	}
	function addClickHandlers() {
		$("#upvote").click( function() { upvote("up") });
	}
	
	$(document).ready(addClickHandlers);
</script>
 
<div class="well span8">
                <dl>
                    {% for post in posts %}
                        <table>
                        <tr>
                        <td><a href="#" id="upvote" onclick="upvote('{{post.pk}}', 'up');">
                        
                                {% if post not in user.likes.all or user == 'Anonymous' %}^&nbsp;{% else %}

                                <font color="red">&nbsp;&nbsp;</font>{% endif %} 
								
                            </a>
                        </td>
                        <td>
                                <table>
                                <tr><td>
                                    <a href="{{post.link}}">{{post.title}}</a>
                                </td></tr>
                                <tr><td>
                                    {{post.description}}
                                </td></tr>
                                <tr><td>
                                <small>by 
                                <a href="/users/{{post.user}}/">{{post.user}}</a>
                                
                                
                                {{post.created|naturaltime}} | 
                                <a href="{% url notes.views.post post.pk %}">{{post.num_comments}} 
                                
                                {% if post.num_comments == 1 %}
                                Comment
                                {% else %}
                                Comments
                                {%endif%}
                                
                                
                                </a> | <div id="ratingDiv-{{post.pk}}">{{post.rating}} points</div></small>
                                
                                </td></tr>
                                </table>
                        </td>
                        </tr>
                        </table>
                        <br>
                    {% endfor %}
                </dl>
</div>
      {% endblock %}


